<div style="margin-top:15px">
      @if(Model.options.FromDate==Model.options.ToDate)
        {
           <h2> @Model.Title Daily Report for @Model.Date.ToString("dddd, dd MMMM yyyy") </h2>
        }
        else
        {
           <h2>@Model.Title Daily Report for @Model.options.FromDate.ToString("dddd, dd MMMM yyyy") - @Model.options.ToDate.ToString("dddd, dd MMMM yyyy")</h2>
        }  

    <div style="margin-top:40px">
        <h3>Sprint status</h3>
        <div style="margin-top:30px">           
          
            @if (Model.SprintReport.RecentlyCompletedTasks != null)
            {
                <div style="margin-top:20px">
                    <h4>Recently completed</h4>
                    @foreach (var task in Model.SprintReport.RecentlyCompletedTasks)
                    {
                        <div style="margin-top: 10px; color: rgb(11, 135, 10);">
                            @if (DateTime.Compare(task.ResolutionDate, Model.options.FromDate.AddDays(1))>0)
                            {
                                <span style="font-family: Segoe UI Symbol">&#10004;</span>
                                <a style="color: rgb(11, 135, 10); text-decoration: none" href="@task.Issue.Link">@task.Issue.Summary</a>
                                <span>(@task.Issue.Key)</span>
                                if (task.Issue.Assignee != null)
                                {                                                            
                                        <span>(completed @task.CompletedTimeAgo ago by @task.Issue.Assignee)</span>                                                             
                                }
                                else
                                {
                                    <span>(completed @task.CompletedTimeAgo ago)</span>
                                }
                            }
                            else
                            {   <b>
                                <span style="font-family: Segoe UI Symbol">&#10004;</span>
                                <a style="color: rgb(11, 135, 10); text-decoration: none" href="@task.Issue.Link">@task.Issue.Summary</a>
                                <span>(@task.Issue.Key)</span>
                                @if (task.Issue.Assignee != null)
                                {
                                    <span>(completed @task.CompletedTimeAgo ago by @task.Issue.Assignee)</span>
                                }
                                else
                                {
                                    <span>(completed @task.CompletedTimeAgo ago)</span>
                                }
                               </b>
                            }                           
                        </div>
                    }
                </div>
            }

            @if (Model.SprintReport.InProgressTasks != null)
            {
                <div style="margin-top:20px">
                    <h4>In progress</h4>
                    @foreach (var task in Model.SprintReport.InProgressTasks)
                    {                                              
                            <div style="margin-top: 10px;">
                                <span style="font-family: Segoe UI Symbol">&#10065;</span>
                                <a style="color:black; text-decoration: none" href="@task.Issue.Link">@task.Issue.Summary</a>
                                <span>(@task.Issue.Key)</span>
                                @if(task.Issue.TimeSpent>0)
                                {
                                    <span>(@task.Issue.TimeLogged worked, @task.Issue.RemainingEstimate left</span>
                                }
                                @if (task.Issue.Assignee != null)
                                {
                                    <span> assigned to  @task.Issue.Assignee)</span>
                                }     
                                else
                                {
                                    <span>)</span>
                                }              
                            </div>                        
                    }
                </div>
            }

        </div>
    </div>
   
    <div style="margin-top: 40px">
        @if(Model.Authors.Count==0)
        {
            <span><b>No work logged</b></span>
        }
            else
        {     
        <b> @Model.TotalTime worked</b>
        <div style="margin-top:10px">
            @foreach(var summary in Model.Summary)
            {
                <div>@summary.TimeLogged - @summary.Name</div>
            }
        </div>
           foreach (var author in Model.Authors)
            {
                <div style="margin-top:40px">
                    <b>@author.Name - @author.TimeLogged</b>

                    @foreach (var issue in author.Issues)
                    {
                        <div style="margin-top:10px">
                            <span>@issue.TimeLogged</span>
                           @if (issue.Label != Model.policy.PermanentTaskLabel)
                            {
                              if(issue.Resolution!=null)
                                  {
                                      <span>(@issue.Resolution)</span>                              
                                  }
                              
                                  else if(issue.RemainingEstimate!=null)
                                  {
                                      if (issue.RemainingEstimateSeconds==0)
                                      {
                                          <span>(<b style="color:red">@issue.RemainingEstimate left</b>)</span>
                                      }
                                      else
                                      {
                                          <span> (@issue.RemainingEstimate left) </span>
                                      }
                                  }
                            }
                            @if(issue.SubTask==true)
                            {
                                 <span> - <a href=@issue.Parent.Link style="text-decoration: none"> @issue.Parent.Summary </a>(@issue.Parent.Key)/<a href=@issue.Link style="text-decoration: none"> @issue.Summary</a> (@issue.Key) </span>
                            }
                            else
                            {
                                 <span> - <a href=@issue.Link style="text-decoration: none"> @issue.Summary</a> (@issue.Key) </span>
                            }                                  
                            @if (issue.Label != Model.policy.PermanentTaskLabel)
                            {
                                if(issue.Assignee==null)
                                {
                                    <span>(Unassigned)</span>
                                }  
                                else if(issue.Assignee!=author.Name)
                                {
                                    <span>(Assigned to @issue.Assignee)</span>
                                }
                            }
                            @foreach (var entry in issue.Entries)
                            {
                                <div>
                                    @if (entry.Comment != "")
                                    {
                                        <div style="margin-top:10px">
                                            @foreach (string comment in entry.Comment.Split('\n'))
                                            {
                                                <div style="margin-left:35px"> @comment</div>
                                            }
                                        </div>
                                    }
                                </div>
                            }
                        </div>
                    }
                </div>
              }
         }
    </div>
   <div style="margin-top:30px">
      <h2>Completed during the last week</h2> 
         <div style="margin-top:20px">                
             @{
              var bold="";
             }
            
                 @foreach (var task in Model.SprintReport.OldCompletedTasks)
                      {
                          if (DateTime.Compare(task.ResolutionDate, Model.options.FromDate.AddDays(1)) > 0)
                          {
                              bold = "font-weight: bold;";
                          }
                          else
                          {
                              bold = "font-weight: normal;";
                          }                                       
                            <div style="margin-top: 10px; color: rgb(11, 135, 10);@bold">

                                <span style="font-family: Segoe UI Symbol">&#10004;</span>
                                <a style="color: rgb(11, 135, 10); text-decoration: none" href="@task.Issue.Link">@task.Issue.Summary</a>
                                <span>(@task.Issue.Key)</span>
                                @if (task.Issue.Assignee != null)
                                {
                                    <span>(completed @task.CompletedTimeAgo ago by @task.Issue.Assignee)</span>
                                }
                                else
                                {
                                    <span>(completed @task.CompletedTimeAgo ago)</span>
                                }
                            </div>
                        }
        </div>
   </div>

</div>
