<div class="jumbotron jumbo">
    <div class="container">
        <h1>
            Instances
        </h1>
        <p class="help-block">
            Use this page to configure all options for the Daily Report.
        </p>
    </div>
</div>

<div class="table">
    <div class="container" ng-if="status == 'loading'">
        <h3>
            <span class="glyphicon glyphicon-refresh glyphicon-refresh-animate"></span> Loading...
        </h3>
    </div>
    <div class="container" ng-if="status == 'loaded' && !instances.length">
        <h1>
            <span class="alert-danger">
                No instances available
            </span>
        </h1>
        <p class="help-block">
            Daily Report tool is unable to find any instance.
        </p>
    </div>
    <div class="container" ng-if="status == 'loaded' && instances.length">
        <div class="row">
            <label class="col-sm-9 col-md-9">
                Instance name
            </label>
            <label class="col-sm-3 col-md-3">
                Options
            </label>
        </div>
        <div class="row project" ng-repeat="instance in instances">
            <div class="col-sm-9 col-md-9">
                {{instance.baseUrl}}
            </div>
            <div class="col-sm-3 col-md-3">
                <a ng-href="app/instances/{{instance.id}}/projects/" class="btn btn-default">View Projects</a>
                <button class="btn btn-default" ng-click="editInstance(this)" ng-disabled="addingInstance || editingInstance">Edit Instance</button>
            </div>
        </div>
        <div class="row project" ng-show="addingInstance || editingInstance">
            <div class="panel panel-default">
                <div class="panel-heading">
                    <h4>
                        JIRA
                    </h4>
                </div>
                <div class="panel-body" ng-form="form">
                    <div class="row">
                        <div class="col-md-6">
                            <div class="form-group">
                                <label>
                                    Username
                                </label>
                                <div>
                                    <input type="text" class="form-control" placeholder="e.g. JIRA username" required ng-model="form.jiraUsername" />
                                </div>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="form-group">
                                <label>
                                    Password
                                </label>
                                <div>
                                    <input type="password" class="form-control" placeholder="e.g. Jira password" required ng-model="form.jiraPassword" />
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-md-8">
                            <div class="form-group">
                                <label>
                                    Instance Url
                                </label>
                                <div ng-form="instanceUrlForm">
                                    <input name="instanceUrl" type="text" class="form-control" placeholder="e.g. Jira Instance Url" required ng-model="form.baseUrl" ng-focus="instanceUrl.focus = true" ng-blur="instanceUrl.focus = false" ng-pattern=regex.Url ng-disabled="editingInstance" />
                                    <span class="form-notification" ng-show="instanceUrlForm.instanceUrl.$error.pattern && !instanceUrl.focus"><b>Enter valid url</b> (http://drt.equilobe.com:33256/)</span>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-4">
                            <div class="form-group">
                                <label>
                                    Time Zone
                                </label>
                                <div>
                                    <select class="form-control" ng-model="form.timeZone" ng-options="timeZone.id as timeZone.name for timeZone in timeZoneList"></select>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="row">
                <div class="col-md-10"></div>
                <div class="col-md-2">
                    <button class="btn btn-danger" ng-click="clearInstanceForm(this)">Cancel</button>
                    <button class="btn btn-success" ng-disabled="form.$invalid || form.$pristine && status != 'error'" ng-click="saveInstance(this)">Save</button>
                    <span class="alert-warning glyphicon glyphicon-share-alt" ng-show="form.$dirty"></span>
                    <span class="alert-info glyphicon glyphicon-refresh glyphicon-refresh-animate" ng-show="status == 'saving'"></span>
                    <span class="alert-danger glyphicon glyphicon-remove" ng-show="status == 'error' && form.$pristine"></span>
                </div>
            </div>
        </div>
        <div class="row project" ng-show="!addingInstance && !editingInstance">
            <div class="col-sm-10 col-md-10"></div>
            <div class="col-sm-2 col-md-2">
                <button class="btn btn-default" ng-click="addInstance(this)">Add New Instance</button>
            </div>
        </div>
    </div>
</div>